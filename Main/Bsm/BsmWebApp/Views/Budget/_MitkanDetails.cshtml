@model BsmWebApp.ViewModels.Budgets.BudgetMainViewModel

  <script>
      var valid;
      $(document).ready(function () {
          $("#MitkanName").kendoAutoComplete({
              // placeholder: "Enter site ...",
              // dataTextField: "SiteName",
              dataTextField: "TeurYechida",
              dataValueField: "KodYechida",
              filter: "startswith",
              minLength: 1,
              change: function (e) {
                  var autocomplete = $("#MitkanName").data("kendoAutoComplete");
                  var dataItem = autocomplete.dataSource.data();
                  var selectedVal = autocomplete.value();
                  var isExist = false;
                  $.each(dataItem, function (key, value)
                  {
                      if (selectedVal===value.TeurYechida)
                      {
                          isExist = true;
                      }
                  });
                  if (isExist == false) {
                      alert("מתקן לא קיים/אינך רשאי לצפות במתקן זה");
                      $("#btnExec").click();
                      $("#btnExec").attr('disabled', 'disabled');
                     
                  }
                  else $("#btnExec").removeAttr('disabled');
                
              },
              dataSource: {
                  type: "json",
                  serverFiltering: true,
                  serverPaging: true,
                  pageSize: 20,
                  transport: {
                      read:
                          {
                              url: "Budget/GetMitkanStartsWith?taarich=@Model.Month"
                          }, //read
                      parameterMap: function () {// send value of autocomplete as the "startsWith" parameter
                          return {
                             
                          startsWith: $("#MitkanName").data("kendoAutoComplete").value()
                          };
                      }
                  } //transport
              } //datasource
          }); //kendoAutoComplete
      }); //DocumentReady
     
        </script>
<div >
    @*<h4>MitkanBudget</h4>*@
    
    @using (Html.BeginForm())
    { 
        <div style="padding:10px; text-align:right" >
            <span class="col-md-9">
                 <span class="textBold" style="padding-left:10px">תאריך:
                  @Html.DropDownListFor(m => m.SelectedMonth, Model.Months, new { @onchange = "EnableButton();" }) </span>
                  <span  style="padding-left:20px">
                      <input type="button" id="btnPrevMonth" value="<  חודש קודם"  class="monthButton medumFont"   />
                      <input type="button" id="btnNextMonth" value="חודש הבא  >"    class="monthButton medumFont"  />
                  </span>

                 <span >
                      <input type="submit"  id="btnShow" value="הצג >>"  name='action:Index'    class="purpleButton title"   />     
                  </span>
            </span>
            <span class="col-md-3 tabFont  text-left">
                סגירת משכורת: יום חמישי 30/10/2015  
                <img src="~/Content/Images/warning.png" />
            </span>

           
        </div>
          if (Model.IsMitkanBudgetDetailEmpty == false)
            {
                <div  class="col-md-2 "> <span class="tabFont">תקציב חודשי:</span>
                                <label   class="txtBoxRO medumFont" style="width:120px;" >    @Html.DisplayFor(model => model.MitkanBudgetDetail.BudgetVal)
                                     <span style="text-align:left"><img src="~/Content/Images/alert.png" /></span>
                                 </label>
                </div>
                <div  class="col-md-4 "> <span class="tabFont" >שעות שבוצעו:</span>
                                  <label   class="txtBoxRO medumFont" style="width:120px" >   @Html.DisplayFor(model => model.MitkanBudgetDetail.BudgetVal)
                                     <img src="~/Content/Images/alert.png" />
                                 </label>
                </div>
        
                <div  class="col-md-2 "> <span class="tabFont">שעות שהוקצו:</span>
                                 <span class="txtBoxRO" style="width:100px">    @Html.DisplayFor(model => model.MitkanBudgetDetail.BudgetVal)
                                     <img src="~/Content/Images/alert.png" />
                                 </span>
                </div>
                <div  class="col-md-4 "> <span class="tabFont" >שעות שנותרו להקצאה:</span>
                                 <span class="txtBoxRO" style="width:100px">    @Html.DisplayFor(model => model.MitkanBudgetDetail.BudgetVal)
                                     <img src="~/Content/Images/alert.png" />
                                 </span>
                </div>
            }   
       
           
        
    }
  
</div>
    

 <div id="dialog" title="Basic dialog" style="overflow: hidden;">

 </div>

<script type="text/javascript" >

    function EnableButton() {
        if ($('#MitkanName').val() != "")
            $("#btnExec").removeAttr('disabled');
        else 
            $("#btnExec").attr('disabled','disabled');
        ;
    }

    function ShowPopUp(kod, name, month) {
        var titel = " פירוט שעות הוספה/הפחתה למתקן ";
        titel = titel + name + " לחודש " + " \n ";
        titel = titel + month;
            $("#dialog").html("")
                .dialog("option", "title", titel )
                .load('/Budget/DispalyChanges?KodYechida=' + kod + "&chodesh=" + month, function () { $("#dialog").dialog("open"); });

    }

    $(function ()
    {
        $("#dialog").dialog(
            {
                autoOpen: false, width: 'auto',
                height: 'auto',
                modal: true,
                buttons: {
                    "סגור": function () {
                        $(this).dialog("close");
                    }
                }
            });
    });

    
        //var url = "/Budget/DispalyChanges?KodYechida=" + kod + "&chodesh=" + month;
     
        //$(function () {
        //    $("#dialog").dialog(
        //        {
        //            autoOpen: false,
        //            width: 400,
        //            height: 450,
        //            modal: true,
        //            buttons: {
        //                "Close": function () {
        //                    $(this).dialog("close");
        //                }
        //            }
        //        });
        //    $.get(url, function (data) {
        //        $("#dialog").html(data);
        //    });
        //    $('#dialog').dialog('open');
        //});


</script>
