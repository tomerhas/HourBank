@using BsmWebApp.ViewModels
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>מערכת בנק שעות</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title - My ASP.NET Application</title>
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")

    @Scripts.Render("~/bundles/jqueryUi")
    @Scripts.Render("~/bundles/modernizr")
    @Scripts.Render("~/bundles/kendo")

    @Styles.Render("~/Content/kendo/css")
     @Styles.Render("~/Content/css")
   
    <script src="@Url.Content("~/Scripts/jquery.mask.js")" type="text/javascript"></script>
   @* <script src="@Url.Content("~/Scripts/jquery.maskedinput.js")" type="text/javascript"></script>*@
    <script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

   <script> function AlertMessage(msg, height, width) {
     $('.ui-dialog').css("clear", "both");
     $("#dialog-message").html(msg);
     $("#dialog-message").dialog({
         resizable: false,
         modal: true,
         title: "הודעה",
         height: height,
         focus: function (event, ui) { document.activeElement.blur(); }
     });

 }</script>

</head>

<body dir="rtl">
    @{
        LayoutViewModel MenuModel = ViewBag.LayoutViewModel;
    }
    <div class="col-md-4" style="padding-right:10px;padding-top:10px;">
      <div id="logo"> </div>
      <div id="GeneralTitle">מערכת ניהול שעות עבודה משק</div>
    </div>
    
     <div id="divProgress" class="Progress"  style="text-align:right;position:absolute;left:52%;top:35%; z-index:1000;display:none" >
          <img src="~/Content/Images/progress.gif" style="width: 100px; height: 100px" />
     </div>   
      
    <div >
         @if (MenuModel.Yechidot.Count() == 1)
          {
             <span class="col-md-7 text-left name"> שם מוסך: @MenuModel.MitkanName.TeurYechida |</span>
          }
          else
          {
             <span class="col-md-7 text-left name">@Html.DropDownListFor(m =>  @MenuModel.MitkanName.KodYechida, @MenuModel.Yechidot , new { onchange = "ChangeCurrentMitkan(this.options[this.selectedIndex].value);", @class = "ddlMitkan" })  | </span>@* @*//new { @onchange = "EnableButton();", @class = "ddl" }*@
                                                
               @*<span class="col-md-7 text-left name">@MenuModel.MitkanName.KodYechida  @Html.DropDownListFor(m =>  @MenuModel.MitkanName.KodYechida, @MenuModel.Yechidot, new { autopostback = "false" , onchange = "document.location.href = '/Budget/Index?mitkan=' + this.options[this.selectedIndex].value;", @class = "ddlMitkan" })  | </span>*@ @*//new { @onchange = "EnableButton();", @class = "ddl" }*@
          }
          
         <span class="col-md-1 text-left name"> @MenuModel.Username </span>
          
        
    </div>
    <div class="bgGray">
          <div id="HeaderGray">
             <div class="col-md-5">
                     <ul class="nav navbar-nav menu">
                            @if (MenuModel != null)
                            {
                                foreach (var menu in MenuModel.Menus)
                                { 
                                    <li class="liBarMenue @menu.TabClassName">
                                       <div id="@menu.ImagSrc"> </div>
                                       <div class="MenuTitle"> @Html.ActionLink(menu.LinkText, menu.ActionName, menu.ControllerName, new object { }, new { @class = "headerLink" })</div>
                                    </li>
                                }
                            }
              
                        </ul>
               </div>
               <div class="col-md-7">
                   <div align="left" style="padding-top: 14px;">
                        <label class="GeneralText" >חישוב אחרון של התקציב: </label>
                       <label class="GeneralText" >@MenuModel.LastDateCalc</label>
                   </div>
               </div>
            </div>
    </div>
         <div>
             <div name="dialogP" id="dialog-message"></div>
                @RenderBody()
               
              @*  <footer>
                    <p>&copy; @DateTime.Now.Year - My ASP.NET Application</p>
                </footer>*@
            </div>   

    @RenderSection("scripts", required: false)

    <script type="text/javascript">

       
       // $(document).ready(function () {
       //  //   $(".ddlMitkan option").css("background", "white");
       //  //   $(".ddlMitkan option").css("color", "black");
       //});

        function ChangeCurrentMitkan(id) {
            
            jQuery.ajax({
                url: "/Budget/ChangeMitkan?mitkan=" + id,
                type: 'POST',
                contentType: 'application/json',
                //  data: JSON.stringify({ data: data2 }),
                success: function (result) {
                    if (result.message == "Session Time out") {
                        window.location.href = "/Home/Session_End";
                    }
                }
            });

            //var url = "/Budget/ChangeMitkan?mitkan=" + id;
           
            //$.get(url, function (data) {
            //    alert(url);
            //    // do something if necessary
            //});
        }

        function showProgress() {
            $("#divProgress").show();
        }

        function AlertMessagePosition(x, y, title, msg, height, width) {
        
            $("#dialog-message").html(msg);
            $("#dialog-message").dialog({
                resizable: false,
                modal: true,
                title: title,
                height: height,
               // position: { my: 'top', at: 'top+700' },
              //  position: [ x+'px', y+'px' ],
             //   position: [30, 100],
               // position: ["left", 1000],

                // position: { my: position.top, at: position.left },
                focus: function (event, ui) { document.activeElement.blur(); }
            });
            
            $("#dialog-message").parent().css('top', y);// "'"+ (y + 20) +"px'");
            $("#dialog-message").parent().css('left',x);// "'"+x+"px'");

         //   $("#dialog-message").parent().css({ top: 200, left: 200 });
        }
        
       
        </script>
</body>

   
</html>
